<!DOCTYPE html>
<html>

<head>
	<meta name="baidu-site-verification" content="code-GKb2vGn6sE" />
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
	<title>원신지도</title>
	<meta charset="utf-8">
	<script>
		var _hmt = _hmt || [];
		(function () {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?cd4f7eed0a6e62d83b92c5dfb9f1a20f";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
		})();
	</script>
</head>
<script src="js/jquery-3.5.1.min.js"></script>

<body>

	<br>
	由于用户并发过大，服务器无法负担并发需求，网页版地图服务在高峰期间（夜间8-12点）会有异常卡顿现象。您可以<a href="https://azz.net/YuanShenDiTu" target="_bal" class="zanzhu">捐助我们</a>，帮助我们度过难关。
	<br>중국어판 후원사이트 생겼다는 링크
	<br>대충 트래픽 감당안되니까 다운로드버전 쓰라는 내용
	<br>
	한글판은 <a href="https://github.com/chocosobo/genshinmap-ko">링크</a> 에서 지속적으로 업데이트 예정


	</br>各位旅行者仍可继续使用在线地图，我们也会提供离线版的地图支持，并且支持导入您在网站中标记的数据。最新离线版下载盘版地址：
	</br>链接：<a href="https://pan.baidu.com/s/1BjHHufitEto80cIsr7kJow"
		target="_blank">https://pan.baidu.com/s/1BjHHufitEto80cIsr7kJow</a>
	</br>
	提取码：KYJG
	</br>您也可以加群下载离线更新包：1群765302904（已满）；2群853210278（已满）；3群932683801（已满）；4群1139510554（已满）；5群1149599151（未满），若均已满，各群密码均为123456
	</br><button id="submitMarker">一键复制并下载标记点位记录</button> 【使用说明】将导出数据的内容复制到离线版的导入框中，提交即可
	</br>
	</br>PS.在线地图中点击存档也可下载点位记录并记录到剪切板或用下方按钮跳转到上传点位记录页面
	</br>
	</br><button id="update">点击跳转到上传页面</button>
	</br>
	</br><button id="enterIndex">进入聚合版在线地图</button>
	</br>
	</br><button id="enterIndex2">进入无聚合版在线地图</button>
</body>
<script>
	// 复制的方法
	function copyText(text, callback) { // text: 要复制的内容， callback: 回调
		var tag = document.createElement('input');
		tag.setAttribute('id', 'cp_hgz_input');
		tag.value = text;
		document.getElementsByTagName('body')[0].appendChild(tag);
		document.getElementById('cp_hgz_input').select();
		document.execCommand('copy');
		document.getElementById('cp_hgz_input').remove();
		if (callback) {
			callback(text)
		}
	}
	$("#submitMarker").click(function () {
		var markedLog = []
		for (var i = 0; i < localStorage.length; i++) {
			var key = localStorage.key(i); //获取本地存储的Key
			if (localStorage.getItem(key) == 1) markedLog.push(key); //所有value
		}
		var eleLink = document.createElement('a');
		eleLink.download = 'markers.json';
		eleLink.style.display = 'none';
		var blob = new Blob([JSON.stringify(markedLog)]);
		eleLink.href = URL.createObjectURL(blob);
		document.body.appendChild(eleLink);
		eleLink.click();
		document.body.removeChild(eleLink);

		toolresult = JSON.stringify(markedLog);
		var texts = toolresult
		copyText(texts, function () {
			alert('复制成功 \n复制内容:' + texts + '\n如果您在当前地图上有标记数据但是这里显示"[]",请与管理员联系恢复您的数据QQ790489566')
		})
		console.log(toolresult);
	})

	$("#submitMarker2").click(function () {
		var markedLog = []
		for (var i = 0; i < localStorage.length; i++) {
			var key = localStorage.key(i); //获取本地存储的Key
			if (localStorage.getItem(key) == 1) markedLog.push(key); //所有value
		}
		toolresult = JSON.stringify(markedLog);
		var texts = toolresult
		copyText(texts, function () {
			alert('복사성공 \n복사 내용' + texts+ '\n如果您在当前地图上有标记数据但是这里显示"[]",请与管理员联系恢复您的数据QQ790489566')
		})
		console.log(toolresult);
	})
	//指定某layer清空
	$("#clearSomeLayer").click(function () {
		var layerId = 26;
		for (var i = 0; i < 1200; i++) {
			var key = layerId + "_" + i;
			localStorage.setItem(key, "");
		}
	})
	//全部清空
	$("#clearAllLayer").click(function () {
		var msg = "모든 태그를 삭제합니까? 손실 방지를 위해 미리 저장하세요.";
		if (confirm(msg) == true) {
			localStorage.clear();
			alert("모든 태그 삭제");
			return true; //你也可以在这里做其他的操作
		} else {
			return false;
		}
	})
	$("#enterIndex").click(function () {
		window.event.returnValue = false;
		window.location.href = 'index.html';
	})
	$("#enterIndex2").click(function () {
		window.event.returnValue = false;
		window.location.href = 'index_old.html';
	})
	$("#update").click(function () {
		window.event.returnValue = false;
		window.location.href = '불러오기.html';
	})
</script>

</html>